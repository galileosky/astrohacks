#include "EllipseFit.h"

#define	N	135

int k;
int n = N;
int m[PARS];
float p[PARS];
float e[PARS];

float x[N] = {
  379,
  681,
  949,
  1185,
  1391,
  1559,
  1682,
  1744,
  1745,
  1684,
  1569,
  1403,
  1195,
  950,
  671,
  364,
  47,
  -261,
  -564,
  -852,
  -1106,
  -1330,
  -1519,
  -1662,
  -1762,
  -1799,
  -1773,
  -1676,
  -1520,
  -1318,
  -1064,
  -769,
  -455,
  -116,
  229,
  552,
  846,
  1098,
  1314,
  1490,
  1624,
  1718,
  1752,
  1722,
  1629,
  1484,
  1298,
  1068,
  798,
  499,
  183,
  -134,
  -441,
  -726,
  -987,
  -1215,
  -1417,
  -1585,
  -1712,
  -1787,
  -1796,
  -1735,
  -1612,
  -1428,
  -1186,
  -900,
  -574,
  -233,
  104,
  432,
  729,
  999,
  1234,
  1428,
  1585,
  1698,
  1750,
  1739,
  1663,
  1530,
  1348,
  1130,
  876,
  592,
  291,
  -13,
  -336,
  -639,
  -921,
  -1171,
  -1388,
  -1563,
  -1698,
  -1781,
  -1798,
  -1746,
  -1627,
  -1454,
  -1232,
  -967,
  -668,
  -334,
  5,
  335,
  646,
  920,
  1157,
  1364,
  1540,
  1668,
  1740,
  1749,
  1691,
  1579,
  1415,
  1216,
  977,
  706,
  412,
  103,
  -215,
  -522,
  -803,
  -1070,
  -1299,
  -1494,
  -1647,
  -1752,
  -1798,
  -1780,
  -1695,
  -1540,
  -1329,
  -1072,
  -778
};

float y[N] = {
  1747,
  1629,
  1462,
  1262,
  1027,
  759,
  462,
  148,
  -164,
  -466,
  -748,
  -1015,
  -1251,
  -1449,
  -1609,
  -1714,
  -1754,
  -1731,
  -1645,
  -1505,
  -1319,
  -1099,
  -849,
  -576,
  -278,
  38,
  362,
  682,
  975,
  1234,
  1462,
  1644,
  1761,
  1812,
  1784,
  1688,
  1533,
  1342,
  1124,
  881,
  615,
  317,
  1,
  -316,
  -618,
  -897,
  -1145,
  -1363,
  -1544,
  -1676,
  -1745,
  -1748,
  -1687,
  -1573,
  -1412,
  -1221,
  -992,
  -737,
  -450,
  -136,
  193,
  514,
  819,
  1104,
  1359,
  1573,
  1725,
  1803,
  1803,
  1732,
  1601,
  1425,
  1212,
  974,
  705,
  409,
  94,
  -223,
  -532,
  -823,
  -1082,
  -1311,
  -1500,
  -1642,
  -1729,
  -1755,
  -1715,
  -1613,
  -1458,
  -1260,
  -1031,
  -774,
  -490,
  -179,
  148,
  476,
  788,
  1069,
  1320,
  1530,
  1690,
  1787,
  1812,
  1760,
  1645,
  1483,
  1288,
  1061,
  794,
  503,
  187,
  -133,
  -442,
  -732,
  -999,
  -1229,
  -1431,
  -1592,
  -1701,
  -1752,
  -1739,
  -1660,
  -1531,
  -1348,
  -1134,
  -888,
  -613,
  -315,
  0,
  317,
  633,
  942,
  1221,
  1456,
  1640
};

void setup()
{
  Serial.begin(115200);
  // do nothing
}

void loop() {
  for (k = 0; k < PARS; k++) {
    p[k] = 0.0;
    e[k] = 0.0;
    m[k] = 1;
  }

  long tStart = millis();
  k = ellipse1_c(&n, x, y, p);
  
  Serial.print("ellipse1=");
  Serial.println(k);
  
  Serial.print("Major axis     = ");
  Serial.println(p[0]);

  Serial.print("Inclination    = ");
  Serial.println(p[1]);

  Serial.print("X position     = ");
  Serial.println(p[2]);

  Serial.print("Y position     = ");
  Serial.println(p[3]);

  Serial.print("Position Angle = ");
  Serial.println(p[4]);

  Serial.print("Time elapsed   = ");
  Serial.println(millis() - tStart);
  
  k = ellipse2_c(&n, x, y, p, e, m);

  Serial.print("ellipse2=");
  Serial.println(k);
  
  Serial.print("Major axis     = ");
  Serial.println(p[0]);

  Serial.print("Inclination    = ");
  Serial.println(p[1]);

  Serial.print("X position     = ");
  Serial.println(p[2]);

  Serial.print("Y position     = ");
  Serial.println(p[3]);

  Serial.print("Position Angle = ");
  Serial.println(p[4]);

  Serial.print("Time elapsed   = ");
  Serial.println(millis() - tStart);
}


